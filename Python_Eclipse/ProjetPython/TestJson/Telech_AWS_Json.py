# -*-coding:Latin-1 -*
'''
Created on 30 nov. 2020

@author: blood
'''
import os
import Configuration

#commande =  "aws s3 sync s3://ican.processed.d2hub.fr/2020-11-27/MARKETIP/864504031504844/ H:/Boulot/TempDownAWSS3/MARKETIP/864504031504844/"
#os.system("start " + commande)

#IMEI_list = ['864504031504844','868996033820754']
#IMEI_list = ["862010039048737","864504031827807","869103026382319","869103026486086","869103026485849","869103026387359","862010039059056","869103026563454","869103026482036","867322034107227","869103026520330","862010038904799","862010038968901","869103026377590","869103026486458","862010039057241","862010039042805","869103026486052","862010039054180","867322034096222","862010038904187","862010038903817","869103026482085","869103026482028","862010038970261","869103026229148","869103026309395","869103026287708","869103026251340","869103026359788","868996033819855","869103026229809","869103026233272","864504031783463","864504031651249","864504039634759","864504039695727","864504031766237","864504039666850","864504039803669","864504031277201","865794031485842","867322034106310","864504031609932","864504031261809","864504031732171","864504031622950","867322034118208","864504031623867"]
IMEI_list = ["867322034109256","867322034094052","867322034092254","867322034096362","867322034111351","862010039059056","868996033832023","867322038574349","868996033813445","867322034081893","868996033815747","869103026309395","868996033849530","864504031504844","867322034098988","867322034112524","864504039667056","867322038042669","867322038060950","867322034109496","867322034100917","867322034101147","869103026382319","868996033827411","868996033819855","864504031129741","867322034097089","869103026520330","869103026482036","867322034105957","867322038046462","864504031766237","864504031783844","868996033827205","867322034097782","868997035945102","867322034095752","868996033827395","864504031430230","867322034111567","868997035950110","862010039042805","867322034098418","867322034109421","868996033831678","867322034098632","868996033832312","867322034087866","867322038025375","868996033831397","867322034098533","868996033823436","864504031625391","867322038574695","867322034081950","867322034103762","867322034101048","867322034094185","868996033824046","868996033820754","869103026473159","867322038031282","865794031287537","867322038061370","869103026288417","868996033812744","867322034079699","864504031277201","867322038569513","864504031128149","867322034087841","868996033823501","862010038904187","862010039048737","867322034082677","864504039648957","868996033831892","867322034107706","868996033831702","867322034081687","868996033832320","867322034105775","864504039666850","867322038604328","867322034097097","864504031602226","869103026292351","868997035958139","867322034109439","867322038610762","867322034109371","867322034098723","867322034107771","869103026482085","867322038036349","868996033813551","868996033813650","868997035955416","864504031778893","868996033820887","867322034107714","869103026359788","864504031261809","864504039691361","867322038041885","867322038042255","864504039803669","868996033826454","867322038046819","867322034114355","868996033831173","868996033834508","867322034119453","868996033824996","868996033835174","867322038042628","867322034093773","865794031462882","868996033823022","867322034090902","868996033843228","869103026277618","863083030585576","869103026387557","867322034081919","869103026270431","868996033813411","868996033826660","868996033815705","867322034087817","867322034095547","868996033815259","867322034101139","867322034110395","867322038049359","867322034100974","867322034106310","867322034081323","867322034084418","868997035955499","867322034085183","869103026485849","867322034109470","867322034116061","867322038041752","862010039057241","868996033832098","867322038025441","868996033828385","867322034081471","868996033831728","867322038609442","868996033836107","867322034109223","867322034082008","867322034087783","867322034080382","867322034094516","867322038581807","867322038609475","868996033826223","867322038578134","867322034082115","867322038021036","868996033815168","867322038049425","869103026306441","868997035955382","867322034104711","867322034111773","869103026229809","868996033827338","862010039054180","867322034107284","869103026427874","862010038903817","865794031339056","867322034100941","867322034079962","867322038610218","868996033828245","867322038573978","867322034111476","867322034080218","867322034081851","868996033827288","867322034111740","867322034100347","868996033836099","867322038020905","867322034102699","864504031609932","867322034111534","867322034109280","867322034107599","868996033832056","864504031784503","867322034088633","868996033837386","867322034085175","867322034096248","869103026387359","867322034080150","867322034080937","867322038041901","868996033827262","867322038612917","868996033813460","868997035954021","867322038612099","868996033815440","862010038973455","868996033813635","868996033826355","868997035952231","867322038021259","868997035954468","869103026482028","864504031227602","864504031444173","868997035951761","864504031783463","864504031732171","867322034108365","867322034117739","868996033822719","867322034096222","867322034081695","867322034111591","864504039695727","868996033830332","869103026377590","867322038609871","864504031766435","868997035960044","862010038968901","864504039634759","864504031619121","867322038575445","867322034110049","867322038023479","867322038008413","867322034095836","867322034104638","864504031261858","867322034116343","867322034087270","868996033832288","867322034084996","867322034107995","867322034098749","867322038612388","868996033840034","867322038573960","867322034086157","868996033835729","867322034115022","867322038030771","867322038579835","868996033836008","867322034106583","867322034083915","869103026233272","869103026251720","868996033832049","868996033820465","865794031485842","869103026246233","867322034116848","869103026563454","869103026514101","868996033813726","867322038577748","867322038622320","867322034084962","864504031651249","869103026486086","867322034107227","867322034099663","867322038609533","867322034104620","867322034086876","869103026251340","867322034094201","864504031622950","867322034113332","868996033839556","867322034102764","867322038051793","867322034096131","868996033831694","868996033832296","867322034094839","868996033832254","867322034084400","867322034106898","867322034080028","867322034094938","864504039671660","867322034097451","868996033816992","868997035950177","867521021998262","867322038609053","867322034117655","867322034118208","869103026276008","867322034111609","867322034118646","868997035953585","868997035951290","862010038904799","868996033813502","867322034111559","867322034113340","867322034098574","868996033823345","867322038042347","864504031623867","867322038041893","864504031609999","864504031827807","868996033823675","869103026287708","867322034102921","862010038970261","867322034098855","867322034102707","867322034115980","867322034110205","867322034103531","868996033832304","869103026486458","868996033830811","868996033837972","867322034107755","867322034098426","868996033831462","867322034100891","867322034104778","867322034100867","867322034082263","868996033827247","867322034111583","867965023138460","864504031130954","867322038574596","868996033827197","867322034111542"]
Date_list = ['2020-11-22','2020-11-24','2020-11-25','2020-11-26','2020-11-27','2020-11-28','2020-11-29','2020-11-30','2020-12-01','2020-12-02','2020-12-03']
Bucket = "/MARKETIP/"
Bucket2 = "/SDPV/"

#strreq = "cmd /c ""echo Téléchargement en cours..... Merci de ne pas fermer cette fenêtre && aws s3 sync s3://ican.processed.d2hub.fr/2020-11-27/MARKETIP/864504031504844/ H:/Boulot/TempDownAWSS3/MARKETIP/864504031504844/ >nul 2>&1"""

liste_cmd_bucket = list()
liste_cmd_bucket2 = list()
liste_cmd_UNMATCHED = list()
liste_cmd_invalid = list()

def gen_liste_cmd():
    global liste_cmd_bucket
    global liste_cmd_bucket2
    global liste_cmd_UNMATCHED
    global liste_cmd_invalid
    liste_cmd_bucket.clear()
    liste_cmd_bucket2.clear()
    liste_cmd_UNMATCHED.clear()
    liste_cmd_invalid.clear()
    for jour in Date_list:
        for imei in IMEI_list:
            str_temp = "start aws s3 sync s3://ican.processed.d2hub.fr/" + jour + Bucket + imei +  "/ " + Configuration.Chemin_json + Bucket + imei + "/"
            liste_cmd_bucket.append(str_temp)
            str_temp = "start aws s3 sync s3://ican.processed.d2hub.fr/" + jour + Bucket2 + imei +  "/ " + Configuration.Chemin_json + Bucket + imei + "/"
            liste_cmd_bucket2.append(str_temp)
            str_temp = "start aws s3 sync s3://ican.processed.d2hub.fr/" + jour + "/UNMATCHED/" + imei +  "/ " + Configuration.Chemin_json + "/UNMATCHED/" + imei + "/"
            liste_cmd_UNMATCHED.append(str_temp)
            str_temp = "start aws s3 sync s3://ican.invalid.d2hub.fr/" + jour + "//" + imei +  "/ " + Configuration.Chemin_json + "/INVALID/" + imei + "/"
            liste_cmd_invalid.append(str_temp)

if __name__ == '__main__':
    gen_liste_cmd()
    nb_req = len(liste_cmd_bucket) + len(liste_cmd_bucket2) + len(liste_cmd_UNMATCHED) + len(liste_cmd_invalid)
    i = 0
    for str_cmd in liste_cmd_invalid:
        i+=1
        os.system(str_cmd)
        print ("Commande " + str(i) + " / " + str(nb_req))
    for str_cmd in liste_cmd_UNMATCHED:
        i+=1
        os.system(str_cmd)
        print ("Commande " + str(i) + " / " + str(nb_req))
    for str_cmd in liste_cmd_bucket:
        i+=1
        os.system(str_cmd)
        print ("Commande " + str(i) + " / " + str(nb_req))
    for str_cmd in liste_cmd_bucket2:
        i+=1
        os.system(str_cmd)
        print ("Commande " + str(i) + " / " + str(nb_req))
    
    pass